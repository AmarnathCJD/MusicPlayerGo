<html>
  <head>
    <meta charset="utf-8" />
    <title>Music Player</title>
    <link
      rel="icon"
      type="image/x-icon"
      href="https://img.icons8.com/fluency/96/000000/music-heart.png"
    />
    <link
      rel="stylesheet"
      hrefhref="https://open.scdn.co/cdn/build/mwp/mwp.8fda9db4.css"
    />
    <style>
      body {
        font-family: sans-serifï¼ŒVerdana, Arial, Helvetica;
        font-size: 10pt;
      }

      #playlist {
        border-radius: 10px;
        padding: 5px 5px 3px 5px;
        width: 290px;
        margin-left: 1px;
        margin-top: 10px;
        height: 500px;
        overflow: auto;
      }

      #btn {
        border-radius: 10px;
        width: 200px;
        margin-left: 1px;
        margin-top: 5px;
        height: 50px;
        overflow: auto;
        background: #694ee4;
        font-weight: bold;
        color: rgb(238, 238, 238);
      }

      #playlist a {
        display: block;
        cursor: pointer;
        padding: 2px 4px;
        border-radius: 5px;
        overflow: hidden;
        margin-bottom: 2px;
      }

      #playlist a.file {
        background: #b4247d;
      }

      #playlist {
        background: #3cb371;
      }

      #playlist a {
        background: #7ccd7c;
      }

      #playlist a.playing {
        background: #9acd32;
        font-weight: bold;
        color: red;
      }

      #playlist a:hover {
        background: #eec900;
      }

      input[type="text"],
      select {
        width: 200px;
        padding: 12px 20px;
        margin: 8px 0;
        display: inline-block;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
      }

      input[type="submit"]:hover {
        background-color: #3dbe43;
      }

      input[type="submit"] {
        width: 200px;
        background-color: #613eb3;
        color: white;
        padding: 14px 20px;
        margin: 8px 0;
        border: none;
        overflow: auto;
        height: auto;
        border-radius: 4px;
        cursor: pointer;
      }

      .center {
        margin: auto;
        width: 50%;
        border: 3px solid green;
        padding: 10px;
      }
      body {
        margin: 0;
        font: 19px / 23px Montserrat, "Montserrat", sans-serif;
        font-family: Verdana;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        background-image: url("https://images.unsplash.com/photo-1524368535928-5b5e00ddc76b?ixlib=rb-1.2.1&ixid=AcLSFNivGXo5DnoPqAdVxHB7qQrUvxjgXxmrGhEFH6v4&auto=format&fit=crop&w=1170&q=80");
      }
      * {
        box-sizing: border-box;
      }

      .player {
        width: 800px;
        height: 529px;
        background: #6b6d83;
        box-shadow: 0px 24px 54px -12px #5e6178;
        position: absolute;
        left: 50%;
        transform: translateX(-400px);
        top: 20%;
      }
      .player .cover {
        width: 230px;
        position: absolute;
        left: 50%;
        transform: translateX(-115px);
        top: -40px;
        box-shadow: 5px 20px 50px 0px rgba(17, 17, 17, 0.4);
      }
      .player .icons {
        position: absolute;
        right: 40px;
        top: 40px;
      }
      .player .icons .fa {
        color: #72e6cf;
        margin-left: 15px;
        font-size: 20px;
      }
      .player .info {
        position: absolute;
        top: 240px;
        left: 20%;
        color: #fff;
        font-family: Open Sans;
        letter-spacing: 1px;
      }
      .player .info .title {
        font-size: 2em;
        margin: 0;
      }
      .player .info .artist {
        color: #bdbdbd;
      }
      .player .line {
        height: 3px;
        width: 100%;
        background-color: #525363;
        position: absolute;
        top: 400px;
      }
      .player .playtime {
        background-color: rgba(114, 230, 207, 0.3);
        height: 5px;
        width: 100%;
        position: absolute;
        bottom: 0px;
      }
      .player .played {
        background-color: #72e6cf;
        height: 5px;
        width: 300px;
        position: absolute;
        bottom: 0px;
      }
      .player svg {
        width: 85px;
        background-color: #fff;
        border-radius: 50%;
        height: 85px;
        position: absolute;
        left: 50%;
        transform: translateX(-42.5px);
        bottom: 25px;
        box-shadow: 0px 0px 40px 0px rgba(0, 0, 0, 0.4);
      }
      .player .forward {
        width: 30px;
        position: absolute;
        bottom: 55px;
        right: -70%;
      }
      .player .backward {
        width: 30px;
        position: absolute;
        bottom: 55px;
        left: 36%;
      }
      .player .fa.fa-volume-up {
        color: #fff;
        position: absolute;
        bottom: 53px;
        right: 28%;
      }
      .player p.songtime {
        color: #fff;
        position: absolute;
        right: 20px;
        bottom: 45px;
      }
      .player p.timeleft {
        color: #fff;
        position: absolute;
        left: 20px;
        bottom: 45px;
      }
      .player .fa.fa-heart.liked {
        color: #ff749f;
      }
    </style>
    <script src="http://www.google.com/jsapi" type="text/javascript"></script>
    <script type="text/javascript">
      var root = "/music/";
      var path = [];

      function init() {
        load(path);
        $("#player").bind("ended", next);
        $("#btn").click(next);
      }

      function load(path) {
        var url = root + path.join("/");
        $.ajax({
          url: url,
          dataType: "json",
          success: function (data) {
            listFile(data);
          },
        });
      }

      function listFile(files) {
        var $b = $("#playlist").empty();

        function addToList(i, f) {
          if (f.Name[0] == "." || f.Name[0] == ":") return;
          var dir = f.IsDir;
          if (dir) return;
          f.Path = path.join("/");
          $("<a></a>")
            .text(f.Name)
            .data("file", f)
            .addClass("file")
            .appendTo($b)
            .click(clickFile);
        }
        $.each(files, addToList);
      }

      function clickFile(e) {
        var f = $(e.target).data("file");
        var name = f.Name;
        var path = f.Path;
        var url = root + path + "/" + name;
        $("#playlist a").removeClass("playing");
        $(e.target).addClass("playing");
        $("#player").attr("src", url);
        $("#player").play();
        $(".player .info").text(name);
        document.getElementById("title").text = name;
      }

      function next() {
        var $next = $("#playlist a.playing").next();
        if ($next.length) $next.click();
      }

      function httpGet(theUrl) {
        var xmlHttp = new XMLHttpRequest();
        xmlHttp.open("GET", theUrl, false);
        xmlHttp.send(null);
        return xmlHttp.response;
      }

      function sleep(ms) {
        return new Promise((resolve) => setTimeout(resolve, ms));
      }

      function search(e) {
        var $form = $(e.target);
        var $input = $form.find("input[id=search]");
        var search = $input.val();
        $.ajax({
          url: root + "search",
          data: {
            search: search,
          },
          dataType: "json",
          success: function (data) {
            fetch(root + "search", {
              method: "GET",
              body: JSON.stringify(data),
              headers: {
                "Content-Type": "application/json",
              },
            });
            init();
            console.log("Hello!");
          },
        });
      }
      google.load("jquery", "1.3.1");
      google.setOnLoadCallback(init);
    </script>
  </head>
  <body>
    <audio id="player" controls autoplay autobuffer>
      <p>What? Your browser doesn't support</p>
    </audio>
    <div id="playlist" class="center"></div>
    <input type="text" id="search" placeholder="Search Songs" />
    <input type="submit" value="Search" onclick="search(this)" />
    <button id="btn" title="skip this song!">Skip</button>
  </body>
</html>
